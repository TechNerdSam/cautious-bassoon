<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Meta Theme Color pour unifier la barre de navigation sur mobile (Top 1% Touch) -->
    <meta name="theme-color" content="#0F172A">
    
    <title>Défi Zéro Déchet de la Semaine</title>
    
    <!-- Favicon "Eco-Nexus" ultra-moderne (SVG intégré Zero-Load) -->
    <link rel="icon" type="image/svg+xml" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" rx="24" fill="%230F172A"/><path d="M30 50C30 35 50 35 50 50C50 65 70 65 70 50C70 35 50 35 50 50C50 65 30 65 30 50Z" fill="none" stroke="url(%23grad)" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/><defs><linearGradient id="grad" x1="0%25" y1="0%25" x2="100%25" y2="100%25"><stop offset="0%25" stop-color="%232DD4BF"/><stop offset="100%25" stop-color="%2334D399"/></linearGradient></defs></svg>'>
    <link rel="apple-touch-icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100" height="100" rx="24" fill="%230F172A"/><path d="M30 50C30 35 50 35 50 50C50 65 70 65 70 50C70 35 50 35 50 50C50 65 30 65 30 50Z" fill="none" stroke="url(%23grad)" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/><defs><linearGradient id="grad" x1="0%25" y1="0%25" x2="100%25" y2="100%25"><stop offset="0%25" stop-color="%232DD4BF"/><stop offset="100%25" stop-color="%2334D399"/></linearGradient></defs></svg>'>

    <!-- Chargement de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chargement de Three.js (Bibliothèque 3D) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <style>
        :root {
            --font-sans: 'Inter', sans-serif;
            --font-display: 'Space Grotesk', sans-serif;
            --color-bg: #0F172A; /* Bleu nuit très sombre */
            --color-text: #E2E8F0;
            --color-text-dim: #94A3B8;
            --color-brand-1: #2DD4BF; /* Teal */
            --color-brand-2: #34D399; /* Emerald */
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--color-bg);
            color: var(--color-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            overflow: hidden; /* Crucial */
            position: relative;
        }

        /* Le Canvas 3D qui se trouve en arrière-plan */
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -10;
            opacity: 0.5; /* On le rend subtil */
            filter: blur(2px); /* Léger flou pour le fond */
        }

        h1, .challenge-text {
            font-family: var(--font-display);
        }

        /* "Glassmorphism" et animation d'entrée */
        .glass-card {
            background: rgba(15, 23, 42, 0.6); /* Fond plus sombre pour le contraste */
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            
            /* Animation d'entrée */
            opacity: 0;
            animation: fade-in-up 1s ease-out 0.3s forwards;
            z-index: 10;
            position: relative;
        }

        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    
    <!-- Canvas pour la scène 3D -->
    <canvas id="bg-canvas"></canvas>

    <!-- La Carte Principale en "Verre" -->
    <div class="glass-card w-full max-w-2xl mx-auto rounded-3xl p-8 md:p-12 text-center overflow-hidden">
        
        <!-- Icône SVG -->
        <div class="w-14 h-14 p-3 bg-white/10 border border-white/10 rounded-full flex items-center justify-center mb-6 mx-auto shadow-lg">
            <svg class="w-full h-full text-emerald-300" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M7 19H4.22a2 2 0 0 1-1.92-2.56l1.8-6.86A2 2 0 0 1 6.02 8h0a2 2 0 0 0 1.92-2.56L6.14 2.5a2 2 0 0 1 .4-1.92l.01-.01A2 2 0 0 1 8.44 2H10"/>
                <path d="m14 10-4 4 4 4"/>
                <path d="M17 5h2.78a2 2 0 0 1 1.92 2.56l-1.8 6.86A2 2 0 0 1 17.98 16h0a2 2 0 0 0-1.92 2.56l1.8 2.94a2 2 0 0 1-.4 1.92l-.01.01a2 2 0 0 1-1.88.5H14"/>
                <path d="m10 14 4-4-4-4"/>
            </svg>
        </div>

        <!-- En-tête -->
        <div class="mb-10">
            <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-[var(--color-brand-1)] to-[var(--color-brand-2)] mb-4 tracking-tight">
                Le Défi Zéro Déchet
            </h1>
            <p class="text-lg text-[var(--color-text-dim)] max-w-prose mx-auto">
                Chaque lundi, un nouveau challenge pour un futur durable.
            </p>
        </div>

        <!-- Conteneur pour le défi actuel (maintenant dynamique) -->
        <div class="bg-white/5 border border-white/5 rounded-2xl p-8 min-h-[180px] flex flex-col justify-center items-center shadow-inner-lg">
            
            <!-- Le texte du défi sera inséré ici par JavaScript -->
            <blockquote id="challenge-text" class="challenge-text text-3xl md:text-4xl font-semibold text-white leading-snug mb-4">
                Chargement du défi...
            </blockquote>
            
            <!-- La date sera insérée ici par JavaScript -->
            <p id="challenge-date" class="text-md text-[var(--color-text-dim)] uppercase tracking-wider font-medium">
                ...
            </p>
        </div>

        <!-- Pied de page -->
        <footer class="mt-12 text-center">
            <p class="text-sm text-[var(--color-text-dim)]">
                Conçu avec soin pour un futur durable.
            </p>
        </footer>
    </div>

    <!-- Script pour la Scène 3D -->
    <script>
        // Initialisation de la scène 3D
        let scene, camera, renderer, knot;
        let mouseX = 0, mouseY = 0;
        let targetX = 0, targetY = 0;

        const windowHalfX = window.innerWidth / 2;
        const windowHalfY = window.innerHeight / 2;

        function init3D() {
            const canvas = document.getElementById('bg-canvas');
            
            // 1. Scène
            scene = new THREE.Scene();
            
            // 2. Caméra
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 4;

            // 3. Renderer
            renderer = new THREE.WebGLRenderer({
                canvas: canvas,
                antialias: true,
                alpha: true // Fond transparent
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio); // Pour écrans retina

            // 4. Lumières
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.2);
            scene.add(ambientLight);

            // Lumière colorée 1 (Sarcelle)
            const pointLight1 = new THREE.PointLight(0x2DD4BF, 2, 10);
            pointLight1.position.set(5, 5, 5);
            scene.add(pointLight1);

            // Lumière colorée 2 (Émeraude)
            const pointLight2 = new THREE.PointLight(0x34D399, 2, 10);
            pointLight2.position.set(-5, -5, -5);
            scene.add(pointLight2);

            // 5. Objet 3D (un "noeud" stylisé)
            const geometry = new THREE.TorusKnotGeometry(1.2, 0.2, 100, 16);
            const material = new THREE.MeshStandardMaterial({
                color: 0xffffff,
                metalness: 0.8, // Très métallique
                roughness: 0.1  // Très lisse pour les reflets
            });
            knot = new THREE.Mesh(geometry, material);
            scene.add(knot);

            // 6. Écouteurs d'événements
            document.addEventListener('mousemove', onDocumentMouseMove, false);
            window.addEventListener('resize', onWindowResize, false);
        }

        // Gérer le mouvement de la souris
        function onDocumentMouseMove(event) {
            mouseX = (event.clientX - windowHalfX) / windowHalfX;
            mouseY = (event.clientY - windowHalfY) / windowHalfY;
        }

        // Gérer le redimensionnement de la fenêtre
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Boucle d'animation
        function animate() {
            requestAnimationFrame(animate);

            // Interpolation douce pour le mouvement de la caméra (effet de parallaxe)
            targetX = mouseX * 0.5;
            targetY = mouseY * 0.5;

            camera.position.x += (targetX - camera.position.x) * 0.05;
            camera.position.y += (-targetY - camera.position.y) * 0.05;
            camera.lookAt(scene.position);

            // Rotation de l'objet
            if (knot) {
                knot.rotation.x += 0.001;
                knot.rotation.y += 0.002;
            }

            renderer.render(scene, camera);
        }

        // Lancement
        window.onload = function () {
            init3D();
            animate();
        }
    </script>

    <!-- NOUVEAU SCRIPT: Mise à jour dynamique du défi -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- Configuration des défis ---
            // Ajoutez autant de défis que vous voulez dans cette liste !
            const weeklyChallenges = [
                "Cette semaine, refusez les pailles en plastique et optez pour une alternative réutilisable !",
                "Apportez votre propre tasse réutilisable pour votre café à emporter.",
                "Passez aux brosses à dents en bambou ou à tête rechargeable.",
                "Achetez en vrac en utilisant vos propres contenants pour réduire les emballages.",
                "Remplacez les bouteilles d'eau en plastique par une gourde durable.",
                "Essayez de faire un 'lundi sans viande' pour réduire votre empreinte carbone.",
                "Utilisez des 'bee wraps' (emballages à la cire d'abeille) au lieu du film plastique.",
                "Fabriquez votre propre produit ménager (ex: vinaigre blanc et eau).",
                "Triez et compostez vos déchets organiques.",
                "Privilégiez les achats de seconde main pour les vêtements ou les objets.",
                "Refusez les prospectus et ajoutez un autocollant 'Stop Pub' sur votre boîte aux lettres.",
                "Calculez votre empreinte carbone de la semaine et essayez de la réduire."
            ];
            // ---------------------------------

            const challengeEl = document.getElementById('challenge-text');
            const dateEl = document.getElementById('challenge-date');

            if (challengeEl && dateEl) {
                // 1. Obtenir la date d'aujourd'hui
                const today = new Date();

                // 2. Calculer le lundi de cette semaine
                const monday = (function(d) {
                    d = new Date(d);
                    const day = d.getDay(),
                        diff = d.getDate() - day + (day === 0 ? -6 : 1); // 0 = Dimanche
                    return new Date(d.setDate(diff));
                })(today);

                // 3. Formater la date du lundi
                const options = { day: 'numeric', month: 'long', year: 'numeric' };
                const dateString = monday.toLocaleDateString('fr-FR', options);
                dateEl.textContent = `Semaine du ${dateString}`;

                // 4. Calculer le numéro de la semaine (pour un index stable)
                const weekIndex = (function(d) {
                    // Copie de la date pour éviter la mutation
                    d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
                    // Règle le jour au jeudi de la semaine actuelle
                    d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));
                    // Date de début d'année
                    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
                    // Calcul du numéro de semaine
                    const weekNo = Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
                    return weekNo;
                })(today);

                // 5. Sélectionner le défi de la semaine
                // L'opérateur Modulo (%) fait en sorte que la liste recommence au début
                const challengeIndex = (weekIndex - 1) % weeklyChallenges.length; // -1 pour un index basé sur 0
                challengeEl.textContent = weeklyChallenges[challengeIndex];
            }
        });
    </script>

</body>
</html>
